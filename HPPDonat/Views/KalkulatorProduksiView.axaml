<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:viewModels="using:HPPDonat.ViewModels"
             mc:Ignorable="d"
             d:DesignWidth="1120"
             d:DesignHeight="760"
             x:Class="HPPDonat.Views.KalkulatorProduksiView"
             x:DataType="viewModels:KalkulatorProduksiViewModel">
  <Grid ColumnDefinitions="1.25*,*" ColumnSpacing="12">
    <StackPanel Grid.Column="0" Spacing="12">
      <Border Classes="hero"
              ToolTip.Tip="Input utama produksi untuk menghitung HPP dan harga jual otomatis.">
        <StackPanel Spacing="4">
          <TextBlock Classes="section-title" Text="Kalkulator Produksi" />
          <TextBlock Classes="muted"
                     Text="Ubah angka di bawah ini untuk melihat dampak biaya dan profit secara realtime. Tidak perlu tombol hitung." />
        </StackPanel>
      </Border>

      <Border Classes="section-panel">
        <StackPanel Spacing="14">
          <StackPanel Spacing="6">
            <TextBlock Text="Berat per Donat (gram)" />
            <NumericUpDown Value="{Binding ProduksiSetting.BeratPerDonat, Mode=TwoWay}"
                           Minimum="1"
                           Maximum="500"
                           Increment="1"
                           FormatString="N2"
                           ToolTip.Tip="BeratPerDonat digunakan untuk menghitung otomatis jumlah donat dari total berat adonan." />
            <TextBlock Classes="muted"
                       Text="{Binding ProduksiSetting.JumlahDonatDihasilkan, StringFormat='Jumlah donat otomatis: {0:N2} pcs'}" />
          </StackPanel>

          <StackPanel Spacing="6">
            <TextBlock Text="Waste (%)" />
            <NumericUpDown Value="{Binding ProduksiSetting.WastePersen, Mode=TwoWay}"
                           Minimum="0"
                           Maximum="99"
                           Increment="0.5"
                           FormatString="N2"
                           ToolTip.Tip="WastePersen = persentase kerusakan atau kehilangan produksi." />
          </StackPanel>

          <StackPanel Spacing="6">
            <TextBlock Text="Target Profit (%)" />
            <NumericUpDown Value="{Binding ProduksiSetting.TargetProfitPersen, Mode=TwoWay}"
                           Minimum="1"
                           Maximum="95"
                           Increment="1"
                           FormatString="N2"
                           ToolTip.Tip="TargetProfitPersen = margin laba untuk menentukan harga jual." />
          </StackPanel>

          <StackPanel Spacing="6">
            <TextBlock Text="Hari Produksi per Bulan" />
            <NumericUpDown Value="{Binding ProduksiSetting.HariProduksiPerBulan, Mode=TwoWay}"
                           Minimum="1"
                           Maximum="31"
                           Increment="1"
                           FormatString="N0"
                           ToolTip.Tip="Jumlah hari produksi yang dipakai untuk estimasi bulanan." />
          </StackPanel>
        </StackPanel>
      </Border>
    </StackPanel>

    <StackPanel Grid.Column="1" Spacing="10">
      <Border Classes="kpi-card" ToolTip.Tip="ProduksiEfektif = JumlahDonatDihasilkan x (1 - Waste/100).">
        <StackPanel>
          <TextBlock Classes="card-title" Text="Produksi Efektif" />
          <TextBlock Classes="card-value" Text="{Binding Ringkasan.ProduksiEfektif, StringFormat='{}{0:N0} donat'}" />
        </StackPanel>
      </Border>

      <Border Classes="kpi-card" ToolTip.Tip="HPPSetelahWaste = TotalModalAdonan / ProduksiEfektif.">
        <StackPanel>
          <TextBlock Classes="card-title" Text="HPP Setelah Waste" />
          <TextBlock Classes="card-value" Text="{Binding Ringkasan.HppSetelahWaste, Converter={StaticResource RupiahConverter}}" />
        </StackPanel>
      </Border>

      <Border Classes="kpi-card" ToolTip.Tip="HargaJual = HPPFinal / (1 - TargetProfitPersen/100), dibulatkan ke atas per Rp100.">
        <StackPanel>
          <TextBlock Classes="card-title" Text="Harga Jual Otomatis" />
          <TextBlock Classes="card-value" Text="{Binding Ringkasan.HargaJual, Converter={StaticResource RupiahConverter}}" />
        </StackPanel>
      </Border>

      <Border Classes="kpi-card" ToolTip.Tip="ProfitPerDonat = HargaJual - HPPFinal.">
        <StackPanel>
          <TextBlock Classes="card-title" Text="Laba per Donat" />
          <TextBlock Classes="card-value" Text="{Binding Ringkasan.ProfitPerDonat, Converter={StaticResource RupiahConverter}}" />
        </StackPanel>
      </Border>

      <Border Classes="kpi-card" ToolTip.Tip="TotalProfit = ProfitPerDonat x ProduksiEfektif.">
        <StackPanel>
          <TextBlock Classes="card-title" Text="Total Profit Batch" />
          <TextBlock Classes="card-value" Text="{Binding Ringkasan.TotalProfit, Converter={StaticResource RupiahConverter}}" />
        </StackPanel>
      </Border>
    </StackPanel>
  </Grid>
</UserControl>
